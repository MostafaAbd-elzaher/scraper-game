
import random

def generate_maze(cols, rows):
    """
    توليد مصفوفة متاهة عشوائية باستخدام خوارزمية البحث بعمق (DFS).
    الشبكة النهائية ستكون ذات خلايا مفردة (1, 0).
    """
    
    # 1. تهيئة الشبكة (Initialization)
    # المتاهة الأصلية ستكون بحجم (rows, cols)
    # لكن المتاهة المرئية (التي تتضمن الجدران) يجب أن تكون (2*rows + 1, 2*cols + 1)
    # كل خلية (مسار) في المتاهة الداخلية تمثل مساحة 2x2 + جدار محيط
    R = 2 * rows + 1
    C = 2 * cols + 1
    
    # املأ الشبكة بالجدران (1) في البداية
    grid = [[1 for _ in range(C)] for _ in range(R)]

    # 2. تطبيق خوارزمية DFS
    # (r, c) هي إحداثيات الخلية في الشبكة الداخلية (المسارات)
    def carve_path(r, c):
        # r_grid و c_grid هي إحداثيات الخلية في الشبكة الكبيرة (grid)
        r_grid = 2 * r + 1
        c_grid = 2 * c + 1
        
        # اجعل الخلية الحالية مساراً (0)
        grid[r_grid][c_grid] = 0

        # الاتجاهات الممكنة (صف, عمود)
        directions = [(0, 1), (0, -1), (1, 0), (-1, 0)]
        random.shuffle(directions) # لضمان العشوائية

        for dr, dc in directions:
            nr, nc = r + dr, c + dc # الخلية المجاورة في شبكة المسارات
            
            # تحقق من حدود شبكة المسارات
            if 0 <= nr < rows and 0 <= nc < cols:
                if grid[2 * nr + 1][2 * nc + 1] == 1:
                    # إذا كانت الخلية المجاورة غير مستكشفة بعد (جدار)،
                    # نحفر الجدار بين الخلية الحالية والخلية المجاورة
                    
                    # إزالة الجدار الفاصل (Wall Removal)
                    wall_r = r_grid + dr
                    wall_c = c_grid + dc
                    grid[wall_r][wall_c] = 0
                    
                    # استدعاء ذاتي (Recursive Call) للاستمرار في الحفر
                    carve_path(nr, nc)

    # ابدأ الحفر من الخلية (0, 0)
    carve_path(0, 0)
    
    # 3. تحديد نقطة البداية والنهاية
    # البداية (Start) - خضراء (سنستخدم 3)
    grid[1][1] = 3 
    
    # النهاية/الكنز (End/Treasure) - صفراء (2)
    # يمكن وضعها في الزاوية المعاكسة (أقصى اليمين والأسفل)
    grid[R - 2][C - 2] = 2

    return grid